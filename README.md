# Документация к проекту

## Обзор
Этот проект содержит конфигурацию Docker для развертывания системы, состоящей из следующих компонентов:
- LDAP-сервер: Используется для аутентификации и хранения информации о пользователях.
- PostgreSQL-сервер: Используется для хранения данных приложения.
- Web-сервер: Разработано с использованием FastAPI и работает на порту 8000.
- Nginx: Прокси-сервер для обработки входящих запросов, проксирует запросы со стандартного порта 80 на порт 8000 web-сервиса.

## Переменные окружения
Для настройки переменных окружения следует создать файл `.env` со следующими значениями:

```
POSTGRES_USER="postgres"
POSTGRES_PASSWORD="postgres"
POSTGRES_HOST="db"
POSTGRES_PORT="5432"
POSTGRES_DB="postgres"

SECRET_KEY_JWT="your-secret-key"
ALGORITHM_JWT="HS256"
ACCESS_TOKEN_EXPIRE_MINUTES="30"

LDAP_ORGANIZATION="site"
LDAP_DOMAIN="site.com"
LDAP_TLS='False'
LDAP_SERVER="ldap://ldap:389"
LDAP_USERNAME="cn=admin,dc=site,dc=com"
LDAP_PASSWORD="admin"
```

Объяснение переменных:
- `POSTGRES_USER`: Имя пользователя для подключения к PostgreSQL серверу.
- `POSTGRES_PASSWORD`: Пароль пользователя для подключения к PostgreSQL серверу.
- `POSTGRES_HOST`: Имя хоста PostgreSQL-сервера (в данном случае `db`, так как это имя сервиса в файле `docker-compose.yml`).
- `POSTGRES_PORT`: Порт PostgreSQL-сервера.
- `POSTGRES_DB`: Название базы данных на PostgreSQL-сервере, которая будет использоваться для хранения данных приложения.
- `SECRET_KEY_JWT`: Секретный ключ для подписания JWT-токенов.
- `ALGORITHM_JWT`: Алгоритм, используемый для подписания JWT-токенов.
- `ACCESS_TOKEN_EXPIRE_MINUTES`: Срок действия JWT-токена в минутах.
- `LDAP_ORGANIZATION`: Название организации для LDAP.
- `LDAP_DOMAIN`: Доменное имя LDAP.
- `LDAP_TLS`: Указывает, будет ли использовано TLS-соединение для LDAP (по умолчанию выключено).
- `LDAP_SERVER`: Ссылка на LDAP-сервер и используемый порт.
- `LDAP_USERNAME`: Имя пользователя LDAP для подключения к серверу LDAP (DN, Distinguished Name).
- `LDAP_PASSWORD`: Пароль пользователя LDAP для подключения к серверу LDAP.

## Как развернуть
Чтобы развернуть систему, выполните следующие шаги:
1. Установите Docker и Docker Compose на вашем компьютере или сервере.
2. Создайте файл `.env` в корневой директории проекта и заполните значения, как указано в разделе "Переменные окружения".
3. В командной строке перейдите в корневую директорию проекта и выполните команду `docker-compose up -d`. Это развернет все сервисы, указанные в файле `docker-compose.yml`, и запустит их в фоновом режиме.

## Отслеживание состояния приложения
Чтобы проверить состояние контейнеров, выполните команду `docker-compose ps`. Если требуется просмотреть логи приложения, выполните команду `docker-compose logs {service_name}`, где `{service_name}` - имя сервиса, логи которого вы хотите просмотреть (например, `web` или `db`).

### Документация OpenAPI
Для просмотра интерактивной документации API, созданной с использованием OpenAPI и Swagger UI, перейдите по адресу `http://{your_domain_or_ip}/docs`. Здесь `{your_domain_or_ip}` - это доменное имя или IP-адрес сервера, на котором развернуто приложение. Здесь вы найдете все доступные конечные точки (endpoints) с описанием и возможностью отправки запросов к API.
